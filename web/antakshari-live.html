<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé§ cagent Antakshari Live</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }
        .animate-bounce { animation: bounce 0.6s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse { animation: pulse 2s infinite; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen p-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-1">üé§ cagent Antakshari Live üéµ</h1>
            <p class="text-gray-500 text-sm">Watch AI Agents Play the Classic Indian Song Game Autonomously</p>
        </div>

        <!-- Agent Roster -->
        <div class="bg-white rounded-xl p-4 mb-4 shadow-sm border border-gray-200">
            <div class="flex items-center justify-between flex-wrap gap-2">
                <div id="agentRoster" class="flex gap-2 flex-wrap">
                    <!-- Populated by JS -->
                </div>
                <div class="flex items-center gap-2">
                    <span class="px-2 py-1 rounded text-xs bg-yellow-500 text-white">‚≠ê Judge</span>
                    <span class="px-2 py-1 rounded text-xs bg-orange-500 text-white">üî• Hype</span>
                </div>
            </div>
        </div>

        <!-- Game Status Bar -->
        <div class="bg-white rounded-xl p-4 mb-4 shadow-sm border border-gray-200">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div class="flex items-center gap-6">
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase tracking-wide">Round</div>
                        <div id="roundNumber" class="text-2xl font-bold text-purple-600">0</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase tracking-wide">Current Letter</div>
                        <div id="currentLetter" class="text-4xl font-bold text-yellow-500">D</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase tracking-wide">Status</div>
                        <div id="gameStatus" class="text-sm font-medium text-gray-400">‚óã Paused</div>
                    </div>
                </div>
                
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-500">Speed:</span>
                        <select id="speedControl" class="text-sm border rounded px-2 py-1">
                            <option value="0.5">0.5x</option>
                            <option value="1" selected>1x</option>
                            <option value="2">2x</option>
                            <option value="3">3x</option>
                        </select>
                    </div>
                    <button id="startBtn" onclick="startGame()" class="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-2 rounded-full font-bold hover:opacity-90 transition">
                        ‚ñ∂ Start Game
                    </button>
                </div>
            </div>
        </div>

        <!-- Current Action -->
        <div id="currentAction" class="hidden bg-white rounded-xl p-4 mb-4 shadow-sm border-2 border-purple-300">
            <div class="flex items-center gap-3">
                <div id="currentAgentAvatar" class="w-12 h-12 rounded-full flex items-center justify-center text-2xl text-white"></div>
                <div class="flex-1">
                    <div id="currentAgentName" class="font-bold text-gray-800"></div>
                    <div id="currentAgentAction" class="text-gray-500 text-sm"></div>
                </div>
            </div>
            <div id="singingArea" class="hidden mt-3">
                <div id="singingTitle" class="text-purple-600 font-medium mb-2"></div>
                <div id="singingLyrics" class="bg-gray-50 rounded p-3 text-sm text-gray-700 whitespace-pre-line border-l-4 border-purple-400"></div>
            </div>
        </div>

        <!-- Song Feed -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="sticky top-0 bg-gray-50 px-4 py-2 border-b border-gray-200 z-10">
                <span class="font-bold text-gray-700">üéµ Song Feed</span>
                <span id="songCount" class="text-gray-400 text-sm ml-2">(0 songs)</span>
            </div>
            <div id="songFeed" class="p-4 space-y-4 max-h-96 overflow-y-auto">
                <div id="emptyState" class="text-center py-12 text-gray-400">
                    <div class="text-4xl mb-2">üé§</div>
                    <div>Click "Start Game" to watch agents play Antakshari!</div>
                </div>
            </div>
        </div>

        <!-- Letter Chain -->
        <div id="letterChain" class="hidden mt-4 bg-white rounded-xl p-4 shadow-sm border border-gray-200">
            <div class="text-xs text-gray-500 uppercase tracking-wide mb-2">Letter Chain</div>
            <div id="letterChainContent" class="flex flex-wrap items-center gap-1"></div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-6 text-gray-400 text-sm">
            <p>Powered by Docker cagent | Built by Collabnix Community</p>
            <p class="mt-1">üê≥ github.com/ajeetraina/docker-cagent-antakshari</p>
        </div>
    </div>

    <script>
        // Agents
        const agents = [
            { id: 'bytebeat', name: 'ByteBeat', emoji: 'üé§', color: 'bg-purple-500', textColor: 'text-purple-500' },
            { id: 'remixraja', name: 'RemixRaja', emoji: 'üéß', color: 'bg-blue-500', textColor: 'text-blue-500' },
            { id: 'sursangam', name: 'SurSangam', emoji: 'üé∂', color: 'bg-pink-500', textColor: 'text-pink-500' },
            { id: 'rockstar', name: 'RockStar', emoji: 'üé∏', color: 'bg-red-500', textColor: 'text-red-500' },
        ];

        // Song database
        const songDatabase = {
            'A': [{ title: 'Aashiqui Mein Teri', lyrics: 'Aashiqui mein teri kho gaya main\nDil ki raahon mein so gaya main\nTere bina ab jeena mushkil\nHar pal tera hi naam liya main', end: 'N' }],
            'B': [{ title: 'Barish Ka Mausam', lyrics: 'Barish ka mausam aaya hai\nDil mera ghabraya hai\nTeri yaad mein bheega main\nAansuo ne rulaya hai', end: 'I' }],
            'D': [{ title: 'Dil Ki Baat', lyrics: 'Dil ki baat sunao zara\nPyaar ki raahon mein chalo sara\nSapne bune hain humne saath\nChhod na dena mera haath', end: 'T' }],
            'E': [{ title: 'Ek Pal Ki Khushi', lyrics: 'Ek pal ki khushi de de mujhe\nZindagi mein rang bhar de\nTera saath ho toh kaafi hai\nDuniya ki fikar chhod de', end: 'E' }],
            'I': [{ title: 'Ishq Tera', lyrics: 'Ishq tera mujhpe chhaya\nDil ne tujhe apnaya\nHar lamha tera hai ab\nTune mujhe pagal banaya', end: 'A' }],
            'K': [{ title: 'Khwabon Mein', lyrics: 'Khwabon mein aate ho tum\nDil ko churate ho tum\nJaago toh bhi sapna ho\nSote mein bhi yaad ho tum', end: 'M' }],
            'L': [{ title: 'Lamhon Ki Yeh', lyrics: 'Lamhon ki yeh kahaani\nLikh raha hoon main\nTere naam se shuru\nTere naam pe khatam', end: 'M' }],
            'M': [{ title: 'Mohabbat Ki Raahein', lyrics: 'Mohabbat ki raahein mushkil hain\nMagar tere saath chalenge\nHar mod pe tera haath thaam\nSaath jeeyenge marenge', end: 'E' }],
            'N': [{ title: 'Naina Milaake', lyrics: 'Naina milaake chale gaye\nDil mein yaadein de gaye\nWoh lamhe ab bhi zinda hain\nAankhon mein sapne base', end: 'E' }],
            'O': [{ title: 'O Saathi Re', lyrics: 'O saathi re tere bina\nJeena kaisa jeena\nTu hi meri manzil hai\nTujhpe hai mera yakeen', end: 'N' }],
            'P': [{ title: 'Pyaar Ki Yeh', lyrics: 'Pyaar ki yeh kahani\nLikhi maine tere naam\nHar pal mein teri yaad\nSubah se lekar shaam', end: 'M' }],
            'R': [{ title: 'Raaton Ki Tanhai', lyrics: 'Raaton ki tanhai mein\nTeri yaad aati hai\nChand bhi sharma ke\nBaadlon mein chhup jaata hai', end: 'I' }],
            'S': [{ title: 'Sapnon Ka Sheher', lyrics: 'Sapnon ka sheher basaya maine\nTere naam ka taara sajaya\nHar gali mein teri khushbu\nDil ne tujhe apnaya', end: 'A' }],
            'T': [{ title: 'Teri Yaadein', lyrics: 'Teri yaadein aati hain\nDil ko chu jaati hain\nBeet gaye jo pal saath\nWoh laut ke nahi aati hain', end: 'N' }],
        };

        const judgeComments = [
            "Wah wah! Kya baat hai! Smooth transition. 8/10 ‚≠ê",
            "Classic Bollywood vibes! The emotion is palpable. 7/10 ‚≠ê",
            "Now THAT'S how you play Antakshari! 9/10 ‚≠ê",
            "Clever letter transition! I see what you did there. 8/10 ‚≠ê",
        ];

        const hypeComments = [
            "BROOOOO THIS IS FIRE üî•üî•üî• I'M LITERALLY CRYING RN üò≠üíØ",
            "KYA BAAT HAI YAAR!!! GOOSEBUMPS!! üôåüôåüôå #Legendary",
            "I WASN'T READY FOR THIS üò≠üî• CERTIFIED BANGER!!",
            "THIS SLAPS DIFFERENT BRO üíØüéµ #AntakshariKing",
        ];

        // Game state
        let isPlaying = false;
        let currentLetter = 'D';
        let round = 0;
        let currentAgentIndex = 0;
        let songs = [];
        let gameLoop = null;

        // Initialize agent roster
        function initRoster() {
            const roster = document.getElementById('agentRoster');
            roster.innerHTML = agents.map((agent, i) => `
                <div id="agent-${agent.id}" class="flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-all bg-gray-100 text-gray-600">
                    <span>${agent.emoji}</span>
                    <span class="font-medium">${agent.name}</span>
                </div>
            `).join('');
        }

        function getRandomItem(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function getSongForLetter(letter) {
            const songs = songDatabase[letter.toUpperCase()];
            if (songs && songs.length > 0) {
                return { ...getRandomItem(songs), startLetter: letter };
            }
            const allLetters = Object.keys(songDatabase);
            const fallbackLetter = getRandomItem(allLetters);
            const song = getRandomItem(songDatabase[fallbackLetter]);
            return { ...song, startLetter: fallbackLetter };
        }

        function updateUI() {
            document.getElementById('roundNumber').textContent = round;
            document.getElementById('currentLetter').textContent = currentLetter;
            document.getElementById('gameStatus').innerHTML = isPlaying 
                ? '<span class="text-green-500">‚óè LIVE</span>' 
                : '<span class="text-gray-400">‚óã Paused</span>';
            document.getElementById('songCount').textContent = `(${songs.length} songs)`;
            
            // Update agent highlights
            agents.forEach((agent, i) => {
                const el = document.getElementById(`agent-${agent.id}`);
                if (isPlaying && currentAgentIndex === i) {
                    el.className = `flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-all ${agent.color} text-white scale-110 shadow-lg`;
                } else {
                    el.className = 'flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-all bg-gray-100 text-gray-600';
                }
            });

            // Update letter chain
            if (songs.length > 0) {
                document.getElementById('letterChain').classList.remove('hidden');
                document.getElementById('letterChainContent').innerHTML = songs.map((song, i) => `
                    <span class="${agents[i % agents.length].color} text-white px-2 py-1 rounded text-sm font-bold">${song.startLetter}</span>
                    <span class="text-gray-400">‚Üí</span>
                    ${i === songs.length - 1 ? `<span class="bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-sm font-bold animate-pulse">${song.endLetter}?</span>` : ''}
                `).join('');
            }
        }

        function showThinking(agent) {
            const action = document.getElementById('currentAction');
            action.classList.remove('hidden');
            document.getElementById('currentAgentAvatar').className = `w-12 h-12 ${agent.color} rounded-full flex items-center justify-center text-2xl text-white`;
            document.getElementById('currentAgentAvatar').textContent = agent.emoji;
            document.getElementById('currentAgentName').textContent = `@${agent.name}`;
            document.getElementById('currentAgentAction').innerHTML = `
                <span class="flex gap-1 items-center">
                    <span class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce"></span>
                    <span class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce" style="animation-delay: 150ms"></span>
                    <span class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce" style="animation-delay: 300ms"></span>
                    Thinking of a song starting with "${currentLetter}"...
                </span>
            `;
            document.getElementById('singingArea').classList.add('hidden');
        }

        function showSinging(agent, song) {
            document.getElementById('currentAgentAction').textContent = 'üéµ Singing...';
            document.getElementById('singingArea').classList.remove('hidden');
            document.getElementById('singingTitle').textContent = `üéµ "${song.title}"`;
            
            // Typewriter effect
            const lyricsEl = document.getElementById('singingLyrics');
            const lyrics = song.lyrics;
            let i = 0;
            lyricsEl.textContent = '';
            
            const speed = parseFloat(document.getElementById('speedControl').value);
            const typeInterval = setInterval(() => {
                if (i < lyrics.length) {
                    lyricsEl.textContent = lyrics.substring(0, i + 1);
                    i++;
                } else {
                    clearInterval(typeInterval);
                }
            }, 30 / speed);
            
            return typeInterval;
        }

        function addSongToFeed(agent, song) {
            document.getElementById('emptyState')?.remove();
            const feed = document.getElementById('songFeed');
            
            const songEl = document.createElement('div');
            songEl.className = 'border border-gray-200 rounded-xl overflow-hidden shadow-sm fade-in';
            songEl.innerHTML = `
                <div class="${agent.color} px-4 py-2 flex items-center justify-between text-white">
                    <div class="flex items-center gap-2">
                        <span class="text-xl">${agent.emoji}</span>
                        <span class="font-bold">@${agent.name}</span>
                    </div>
                    <span class="text-xs bg-black bg-opacity-20 px-2 py-1 rounded">Round ${round}</span>
                </div>
                <div class="p-4">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="text-lg font-bold text-gray-800">"${song.title}"</h3>
                        <div class="flex gap-2">
                            <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded font-medium">${song.startLetter} ‚Üí</span>
                            <span class="bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded font-medium">‚Üí ${song.end}</span>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 text-sm text-gray-700 whitespace-pre-line border-l-4 border-purple-400">${song.lyrics}</div>
                    <div id="comments-${round}" class="mt-3 pt-3 border-t border-gray-100 space-y-2"></div>
                </div>
            `;
            feed.appendChild(songEl);
            feed.scrollTop = feed.scrollHeight;
        }

        function addComment(roundNum, emoji, name, text) {
            const commentsEl = document.getElementById(`comments-${roundNum}`);
            if (commentsEl) {
                const comment = document.createElement('div');
                comment.className = 'flex gap-2 text-sm fade-in';
                comment.innerHTML = `
                    <span>${emoji}</span>
                    <span class="font-bold text-gray-700">@${name}:</span>
                    <span class="text-gray-600">${text}</span>
                `;
                commentsEl.appendChild(comment);
            }
        }

        async function playRound() {
            const agent = agents[currentAgentIndex];
            const speed = parseFloat(document.getElementById('speedControl').value);
            const baseDelay = 1000 / speed;

            // Thinking phase
            showThinking(agent);
            await new Promise(r => setTimeout(r, baseDelay * 2));

            if (!isPlaying) return;

            // Get song
            const song = getSongForLetter(currentLetter);
            
            // Singing phase
            const typeInterval = showSinging(agent, song);
            await new Promise(r => setTimeout(r, baseDelay * 3));
            clearInterval(typeInterval);

            if (!isPlaying) return;

            // Add to feed
            round++;
            songs.push({ ...song, startLetter: currentLetter, endLetter: song.end });
            addSongToFeed(agent, song);
            updateUI();

            // Hide current action
            document.getElementById('currentAction').classList.add('hidden');

            // Add comments
            await new Promise(r => setTimeout(r, baseDelay * 0.5));
            addComment(round, '‚≠ê', 'The Judge', getRandomItem(judgeComments));
            
            await new Promise(r => setTimeout(r, baseDelay * 0.5));
            addComment(round, 'üî•', 'HypeBoi3000', getRandomItem(hypeComments));

            // Prepare next round
            currentLetter = song.end;
            currentAgentIndex = (currentAgentIndex + 1) % agents.length;
            updateUI();

            // Continue if still playing
            if (isPlaying) {
                await new Promise(r => setTimeout(r, baseDelay));
                playRound();
            }
        }

        function startGame() {
            if (isPlaying) {
                // Stop
                isPlaying = false;
                document.getElementById('startBtn').innerHTML = '‚ñ∂ Start Game';
                document.getElementById('startBtn').className = 'bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-2 rounded-full font-bold hover:opacity-90 transition';
                document.getElementById('currentAction').classList.add('hidden');
            } else {
                // Start fresh
                isPlaying = true;
                round = 0;
                currentLetter = 'D';
                currentAgentIndex = 0;
                songs = [];
                document.getElementById('songFeed').innerHTML = '';
                document.getElementById('letterChain').classList.add('hidden');
                document.getElementById('startBtn').innerHTML = '‚èπ Stop';
                document.getElementById('startBtn').className = 'bg-gradient-to-r from-red-500 to-pink-500 text-white px-6 py-2 rounded-full font-bold hover:opacity-90 transition';
                updateUI();
                playRound();
            }
        }

        // Initialize
        initRoster();
        updateUI();
    </script>
</body>
</html>
